<?xml version="1.0" encoding="UTF-8"?>
<!-- This file is part of the SPFE Open Toolkit. See the accompanying license.txt file for applicable licenses.-->
<!-- (c) Copyright Analecta Communications Inc. 2012 All Rights Reserved. -->
<?xml-stylesheet type="text/css" href="../../style/authoring/spfe-docs.css"?>
<generic-topic xmlns="http://spfeopentoolkit.org/spfe-docs/schemas/authoring/generic-topic"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://spfeopentoolkit.org/spfe-docs/schemas/authoring/generic-topic
    http://spfeopentoolkit.org/spfe-docs/topic-types/generic-topic/schemas/generic-topic.xsd">
    
    <head>
        <uri>http://spfeopentoolkit.org/spfe-docs/content/development/directory-structure.xml</uri>
        <author>jkeffer</author>
        <status>In progress</status>
        <history>
            <revision>
                <date>2012-07-19</date>
                <author>jkeffer</author>
                <comment>New topic</comment>
                <new-status>In progress</new-status>
            </revision>
            <revision>
                <date>2012-07-24</date>
                <author>jkeffer</author>
                <comment>New topic</comment>
                <new-status>Ready for technical review</new-status>
            </revision>
            <revision>
                <date>2013-11-28</date>
                <author>mbaker</author>
                <comment>Removing reference to output directory. Now hard coded to topic-set-id.</comment>
                <new-status>In progress</new-status>
            </revision>
        </history>
        <index>
            <entry>
                <type>feature</type>
                <term>{build directory}</term>
            </entry>
        </index>
    </head>
    <body>
        <title>Build directory structure</title>
        <p>If you want use the SPFE Toolkit build system in an automated build, it is helpful to
            understand the directory elements to enable you to organize your directory structure,
            and locate files for status reporting and troubleshooting. This topic explains the
            environment variables, the <feature>configuration file</feature> elements, and their
            relationships.</p>
        <ul>
            <li>
                <p><code>SPFE_BUILD_DIR</code>: Environment variable set in the
                        <tool-name>spfe</tool-name> build tool file (set to
                    <code>HOME</code>/spfebuild). The <directory-name>temp</directory-name>
                    subdirectory stores ANT property and file definitions generated by the script
                        <file-name>config.xsl</file-name>. The variable is not configurable in the
                    configuration file. To change it, in the <code>SPFEOT_HOME</code> directory,
                    edit <file-name>spfe.sh</file-name> (Linux) or <file-name>spfe.bat</file-name>
                    (Windows).</p>
            </li>
            <li>
                <p><config-setting>/spfe/build/build-directory</config-setting>: Stores scripts,
                    the fully resolved configuration files (subdirectory
                        <directory-name>config</directory-name>), and logs (subdirectory
                        <directory-name>logs</directory-name>) generated by the script
                        <file-name>config.xsl</file-name> for each <feature>topic set
                    </feature>during the build. It also stores the configuration files created as
                    output and provided as input to each stage of the build in the subdirectory
                        <directory-name>temp</directory-name>. If you do not define this element,
                    the default is composed of the values of
                    <code>SPFE_BUILD_DIR</code>/<config-setting>doc-set@id</config-setting>/<config-setting>topic-set-id</config-setting>. </p>
            </li>
            <li>
                <p><config-setting>/spfe/build/link-catalog-directory</config-setting>: Stores
                    the link catalogs generated by the link catalog script. The
                    <config-setting>/spfe/sources/link-catalog</config-setting> element must
                    include this directory path. There is no default value and the build fails if
                    you do not define this element and you include the directory in the sources
                    element. If you do not use a link catalog, the build system does not generate
                    links.</p>
            </li>
            <li>
                <p><config-setting>/spfe/build/toc-directory</config-setting>: Stores the toc
                    files generated by the presentation script. The
                    <config-setting>/spfe/sources/tocs</config-setting> element must include
                    this directory path. There is no default value and the build fails if you do not
                    define this element and you include the directory in the sources element. If you
                    do not define a tocs element, the output does not show a table of contents; the
                    build system generates the toc files, but the presentation scripts do not
                    include them.</p>
            </li>
            <li>
                <p><config-setting>/spfe/build/output-directory</config-setting>: Stores the
                    final output of the documentation set (HTML, PDF, etc.) generated by the
                    formatting or encoding script. There is no default value and the EPPO Simple
                    scripts fail if this element is not defined.</p>
            </li>
        </ul>
        <p>In the SPFE docs configuration files, there are two
            <config-setting>define</config-setting> elements used in the element definitions to
            separate files for the build from the final output of the documentation set.</p>
        <codeblock><![CDATA[
            <define name="SPFE_BUILD" value="${HOME}/spfebuild/build"/>
            <define name="SPFE_DOCS" value="${HOME}/spfebuild/spfe-docs"/>]]>
        </codeblock>
        <p>The following elements are defined in spfe-docs-config.xml:</p>
        <codeblock><![CDATA[    
            <build>
                <link-catalog-directory>${SPFE_BUILD}/link-catalogs</link-catalog-directory>
                <output-directory>${SPFE_DOCS}/output</output-directory>
                <toc-directory>${SPFE_BUILD}/tocs</toc-directory>
            </build>]]>
        </codeblock>
        <p>If the user's HOME directory is C:\Users\username, the paths resolve to: </p>
        <p><config-setting>/spfe/build/link-catalog-directory</config-setting>:
            <code>C:\Users\username\spfebuild\build\link-catalogs</code></p>
        <p><config-setting>/spfe/build/toc-directory</config-setting>:
            <code>C:\Users\username\spfebuild\build\tocs</code></p>
        <p><config-setting>/spfe/build/output-directory</config-setting>:
            <code>C:\Users\username\spfebuild\spfe-docs</code></p>
        <p>The following shows the topic set specific elements in the configuration file
            spfe-development-tasks.xml:</p>
        <codeblock><![CDATA[
            <define name="TOPIC_SET_ID" value="spfe-development-tasks"/>
            <build>
                <build-directory>${SPFE_BUILD}/tasks</build-directory>
            </build>
 ]]></codeblock>
        <p>If the user's HOME directory is C:\Users\username, the paths resolve to:</p>
        <p><config-setting>/spfe/build/build-directory</config-setting>:
            <code>C:\Users\username\spfebuild\build\tasks</code>.</p>
    </body>
    
</generic-topic>